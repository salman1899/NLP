import pandas as pd import picklefrom sklearn.pipeline import Pipelinefrom sklearn.linear_model import LogisticRegressionfrom sklearn.model_selection import train_test_splitfrom sklearn.feature_extraction.text import CountVectorizerdf=pd.read_csv("deploy_nlp_data.csv")x=df["body"]y=df["label"]xtrain,xtest,ytrain,ytest=train_test_split(x,y,test_size=.2)model=Pipeline(steps=[('cv',CountVectorizer()),('logi',LogisticRegression())])model.fit(xtrain,ytrain)file_name=open("nlp_deploy_model.pkl","wb")pickle.dump(model,file_name)file_name.close()preds=model.predict(["The mobile is looking good"])print(preds)